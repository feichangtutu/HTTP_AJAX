## AJAX核心原理
@(20180806)
### AJAX基础知识
> async javascript and xml 异步的js与xml

`xml：可扩展的标记语言`
> 作用是用来存储数据的（通过自己扩展的标记名称清晰的展示数据结构）
```xml
<?xml version="1.0" encoding="UTF-8"?>
<kuzi>
    <test>
        haha
    </test>
</kuzi>
```
> 现在ajax一般用json传输数据
> 这里的异步不是只能异步，虽然建议异步，异步在此特指 **异步刷新**
> 全局刷新优势
+ 1.动态展示的页面在源代码中可以看见，有利用seo推广（搜索引擎的抓取和收录）
+ 2. 从服务器获取最终页面无需客户端处理，在服务器性能好的前提下，页面加载速度快，淘宝 京东首屏页面都是服务器端渲染的
> 全局刷新弊端
+ 实时刷新无法实现
+ 服务器端处理量大，处理不过来 速度会更慢 京东淘宝其他屏都是客户端渲染绑定
+ 不利于开发
> 前后端分离,页面中需要动态绑定的数据ji交给服务端完成渲染
+ 向服务器发送ajax请求
+ 把从服务器获取的数据进行处理，拼接成为我们需要展示的字符串
+ 把拼接好的字符串替换页面中某一部分d的内容，局部刷新
> 优点
> 1. 根据需求局部刷新，性能好，整体不刷新
> 2. 利于开发 提高开发效率
> 1) 前后端完全分离
> 2) 同时开发，制定接口文档（接口 协议规范） 前端用node模拟
> 弊端：
> 1. 不利于seo 第一次从服务器获取的内容不包含需要动态绑定的数据，所以页面的原代码中没有这些数据,不利于seo,
> 后期通过js添加到页面中不会显示在源代码中
> 2. 异步ajax请求数据，再绑定数据，浏览器把加载的部分重新渲染,浪费时间，没有服务器端呈现速度快

### 基于原生js实现AJAX

```javascript
// 创建一个ajax对象
let xhr =  new XMLHttpRequest()//不兼容IE6及更低版本（ie6:ActiveObject）
// 打开请求地址
xhr.open([method],[url],[async],[user name],[password])
// 监听ajax状态改变，获取响应信息（响应头 响应主体）
xhr.onreadystatechange = ()=>{
	if (xhr.readyState ==4 && xhr.status ==200){
		let result = xhr.responseText // 获取响应主体
	}
}
// 发送ajax请求（传递请求主体）
xhr.send(null)
```

`第二步中的细节点`
> xhr.open([method],[url],[async],[user name],[password])
> AJAX请求方式
> 1. GET系列请求
> - get
> - delete： 从服务器上删除某些资源文件
> - head： 只想获取服务器返回的响应头信息（响应主体内容不需要获取）
...
> 2. POST系列请求
> - post
> - put :像服务器增加指定的资源 
> ...
>
> 不管哪一种请求方式，客户端都可以把信息传递给服务器，服务器也可以把信息返回给客户端。知识get系列以获取为主，post一般以推送为主
> 1)我们想获取一些动态信息的展示，一般使用GET请求，只需向服务器发送请求，告诉服务端想要什么，服务端就会把需要的数据返回
> 2）在实现注册功能的时候，需要把客户输入的信息发送给服务器进行存储，服务器一般返回成功还是失败装填，此时基于post
#### GET系列请求与POST系列请求，区别：
+ 1.get请求传递给服务器的内容没有post请求传递给服务器的内容多
> 原因： get请求传递给服务器内容一般都是基于`url地址传参`来实现的，而post请求一般都是基于`设置请求主体`来实现的。
各大浏览器都有自己的URL最大长度限制（chrome:8KB, FIREFOX:7KB; IE:2KB）
超过限制长度的部分，浏览器会自动截取掉，导致传递给服务器的数据丢失<br/>
> 理论上POST请求通过请求主体传递是没有大小限制的，真实项目中为了保证传输的速率，w我们也会限制大小（图片）
+ 2.get容易出现缓存，一般不可控，且不需要；post不会出现缓存，除非做特殊处理
> 原因：url传参会有缓存，设置请求主体不会
> 解决方案：在每一次重新请求的时候，url末未追加随机数，可避免从缓存中读取数据
```javascript
$.ajax({
    url: 'getList?lx=news&_='+Math.random(),
    success: result=> {	
    }
})
```
+ get没有post安全 post相对安全
> url劫持 信息泄露
